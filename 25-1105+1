- 数据库的学习！！加油 赶紧搞哦 -- 分库分表，那对于连表的 你咋搞呢
- redis redis的锁， 如果是ap的话--怎么看数据一致性呢？ 尤其是锁！

- 对于系统你还有什么想改进的吗？？

对于消息会不会跌丢失， 我们可以先拆分 消息的一个流程

生产者  -- ACK 保证

中间者-暂存  【这里的话 就要看咯】 

消费者。-- ACK 依赖 消费位点（由消费者自己主动提交）


redis的丢数据的case
AOF 持久化配置为每秒写盘，但这个写盘过程是异步的，Redis 宕机时会存在数据丢失的可能
主从复制也是异步的，
【AOF】 是主线程去完成的噢 --先写命令 再记日志

aof 是先写到缓冲区的，依赖三个模式 去刷盘 【缓冲区一出来】就应该考虑下他的大小，写满了怎么办？ 【AOF重写机制】 --mysql 好像是环形写入，
三种模式去 写回硬盘 
always -- 总是/每次都
everysec --  每秒
no -- byOS 由操作系统决定

【AOF重写 --可以理解成 整理并压缩】（有点像gc，）bgrewriteaof 后台线程哈，  --为啥要提到它， 因为它也用到了Copy on write， 好的 牛掰 写时复制， ConcurrentHashMap ! 记起来了吗？ 还有WAL （write ahead log）

写时复制，-- 说实话我不是很明白- 为啥是有物流地址变化的时候才会触发？ 嗯? 不应该都是复制一份吗？



当然，AOF 持人化切能也个是没有潛任)X险。
1、第一个风险，
执行写操作命令和记录日志是两个过程，那当 Redis 在还没来得及将命令写入到硬盘时，服
务器发生宕机了，这个数据就会有丢失的风险。

2、第二个风险，前面说道，由于写操作命令执行成功后才记录到 AOF 日志，所以不会阻塞当前写操作命令
的的执行，但是可能会给「下一个」命令带来阻塞风险。 ---主线程
因为将命令写入到日志的这个操作也是在主进程完成的（执行命令也是在主进程），也就是说这两个操作
是同步的。




【RDB】是默认开启的， 但是默认配置不知道
配置维度 XX时间内内，至少有XXX次写操作 执行触发 BGSAVE
他是异步的哈， 全部强制刷盘的话 就是bgsave

